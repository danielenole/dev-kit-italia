import{x as k,a as A}from"./iframe-BiclfI91.js";import{r as V,e as $,n as h}from"./query-Bd2ew8Gc.js";const B=({otherProps:s="",otherMethods:t="",otherEvents:e="",componentName:i="it-input"})=>({name:"Proprietà, Metodi, ed Eventi accessibili via js",tags:["!dev"],render:()=>k`<div class="hide-preview"></div>`,parameters:{viewMode:"docs",docs:{description:{story:`Il componente espone delle proprietà, dei metodi e degli eventi, utili per eventuali interazioni via js.

\`\`\`html
<${i} ... id="myinput"></${i}>
\`\`\`

\`\`\`js
const myInput = document.getElementById("myInput");
const validity = myInput.validity;
const validationMessage = myInput.validationMessage;

const form = myInput.getForm();
myInput.checkValidity();
myInput.reportValidity();
myInput.setCustomValidity("Messaggio di errore");
\`\`\`

<br/>
<h4>Proprietà accessibili dall'esterno</h4>
| Nome | Descrizione |
|------|-------------|
|\`validity\`| Ritorna l'oggetto di validazione effettuata dal browser.|
|\`validationMessage\`| Ritorna il messaggio di errore in caso di validazione fallita.|
${s}

<h4>Metodi</h4>
| Nome | Descrizione | Argomenti |
|------|-------------|-----------|
|\`getForm()\`| Ritorna l'elemento del DOM corrispondente alla form di riferimento dell'input. | - |
|\`checkValidity()\`| Triggera la validazione nativa del browser sul campo, e restituisce true o false a seconda che l'input sia valido o meno. | - |
|\`reportValidity()\`| Controlla se l'elemento è valido secondo le regole di validazione del browser. Se non è valido, mostra un messaggio di errore (tooltip nativo del browser) e restituisce \`false\`. Se è valido, restituisce \`true\`. | - |
|\`setCustomValidity('')\`| Permette di impostare un messaggio di errore personalizzato passato come parametro. Se il messaggio non è vuoto, rende invalido l'elemento. Se invece il messaggio è vuoto (''), rende valido l'elemento. | message: String |
${t}


<h4>Eventi</h4>
| Nome | Descrizione |
|------|-------------|
|\`it-input-ready\`| Quando il componente è montato e l'elemento input interno è pronto. |
|\`it-input\`| Ogni volta che il valore di input cambia per interazione da parte dell'utente |
|\`it-blur\`| Quando l'input perde il focus (blur) |
|\`it-focus\`| Quando l'input riceve il focus (focus) |
|\`it-click\`| Quando l'utente fa click sull'input |
|\`it-change\`| Quando il valore dell’input viene modificato e il browser emette \`change\` |
|\`invalid\`| Emesso dal browser quando la validazione fallisce.|
${e}`}}}});function C(s){var t,e,i="";if(typeof s=="string"||typeof s=="number")i+=s;else if(typeof s=="object")if(Array.isArray(s)){var o=s.length;for(t=0;t<o;t++)s[t]&&(e=C(s[t]))&&(i&&(i+=" "),i+=e)}else for(e in s)s[e]&&(i&&(i+=" "),i+=e);return i}function L(){for(var s,t,e=0,i="",o=arguments.length;e<o;e++)(s=arguments[e])&&(t=C(s))&&(i&&(i+=" "),i+=t);return i}const b=new Set;window&&!window.translations&&(window.translations=new Map);const{translations:m}=window;let u,w="ltr",E="en";const M=typeof MutationObserver<"u"&&typeof document<"u"&&typeof document.documentElement<"u";function F(){M&&(w=document.documentElement.dir||"ltr",E=document.documentElement.lang||navigator.language),[...b.keys()].forEach(s=>{const t=s;typeof t.requestUpdate=="function"&&t.requestUpdate()})}if(M){const s=new MutationObserver(F);w=document.documentElement.dir||"ltr",E=document.documentElement.lang||navigator.language,s.observe(document.documentElement,{attributes:!0,attributeFilter:["dir","lang"]})}function I(...s){s.forEach(t=>{const e=t.$code.toLowerCase();m.has(e)?m.set(e,{...m.get(e),...t}):m.set(e,t),u||(u=t)}),F()}window.registerTranslation=I;class D{constructor(t){this.host=t,this.host.addController(this)}hostConnected(){b.add(this.host)}hostDisconnected(){b.delete(this.host)}dir(){return`${this.host.dir||w}`.toLowerCase()}lang(){return`${this.host.lang||E}`.toLowerCase()}getTranslationData(t){var c;const e=new Intl.Locale(t.replace(/_/g,"-")),i=e==null?void 0:e.language.toLowerCase(),o=((c=e==null?void 0:e.region)==null?void 0:c.toLowerCase())??"",r=m.get(`${i}-${o}`),n=m.get(i);return{locale:e,language:i,region:o,primary:r,secondary:n}}exists(t,e){const{primary:i,secondary:o}=this.getTranslationData(e.lang??this.lang()),r={includeFallback:!1,...e};return!!(i&&i[t]||o&&o[t]||r.includeFallback&&u&&u[t])}term(t,...e){const{primary:i,secondary:o}=this.getTranslationData(this.lang());let r;if(i&&i[t])r=i[t];else if(o&&o[t])r=o[t];else if(u&&u[t])r=u[t];else return console.error(`No translation found for: ${String(t)}`),String(t);return typeof r=="function"?r(...e):r}date(t,e){const i=new Date(t);return new Intl.DateTimeFormat(this.lang(),e).format(i)}number(t,e){const i=Number(t);return Number.isNaN(i)?"":new Intl.NumberFormat(this.lang(),e).format(i)}relativeTime(t,e,i){return new Intl.RelativeTimeFormat(this.lang(),i).format(t,e)}}const x=s=>class extends s{constructor(){super(...arguments),this.localize=new D(this)}get $localize(){return this.localize}$t(t){return this.localize.term(t)}$d(t,e){return this.localize.date(t,e)}$n(t,e){return this.localize.number(t,e)}};class z{constructor(t){this.tag=t}format(t,e){return[`[${this.tag}] ${e}`]}warn(t){console.warn(...this.format("warn",t))}error(t){console.error(...this.format("error",t))}info(t){console.info(...this.format("info",t))}}class j extends A{constructor(){super(),this.composeClass=L,this.logger=new z(this.tagName.toLowerCase())}get _ariaAttributes(){const t={};for(const e of this.getAttributeNames())e==="it-role"?t.role=this.getAttribute(e):e.startsWith("it-aria-")&&(t[e.replace(/^it-/,"")]=this.getAttribute(e));return t}generateId(t){return`${t}-${Math.random().toString(36).slice(2)}`}addFocus(t){}getActiveElement(){let t=document.activeElement;for(;t&&t.shadowRoot&&t.shadowRoot.activeElement;)t=t.shadowRoot.activeElement;return t}get focusElement(){return this}get prefersReducedMotion(){return window.matchMedia("(prefers-reduced-motion: reduce)").matches}connectedCallback(){var e;super.connectedCallback();const t=((e=this.id)==null?void 0:e.length)>0?this.id:this.tagName.toLowerCase();this._id=this.generateId(t)}}const R=x(j);function a(s,t,e,i){var o=arguments.length,r=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,t,e,i);else for(var c=s.length-1;c>=0;c--)(n=s[c])&&(r=(o<3?n(r):o>3?n(t,e,r):n(t,e))||r);return o>3&&r&&Object.defineProperty(t,e,r),r}function l(s,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,t)}const f=new WeakMap,p=new WeakMap,g=new WeakMap,y=new WeakSet,v=new WeakMap;class _{constructor(t,e){this.handleFormData=i=>{const o=this.options.disabled(this.host),r=this.options.name(this.host),n=this.options.value(this.host),c=this.host.tagName.toLowerCase(),S=c==="it-button";if(this.host.isConnected&&!o&&!S&&typeof r=="string"&&r.length>0&&typeof n<"u")switch(c){case"it-radio":this.host.checked&&i.formData.append(r,n);break;case"it-checkbox":this.host.checked&&i.formData.getAll(r).indexOf(n)<0&&i.formData.append(r,n);break;default:Array.isArray(n)?n.forEach(O=>{i.formData.append(r,O.toString())}):i.formData.append(r,n.toString())}},this.handleFormSubmit=i=>{var n;const o=this.options.disabled(this.host),r=this.options.reportValidity;this.form&&!this.form.noValidate&&((n=f.get(this.form))==null||n.forEach(c=>{this.setUserInteracted(c,!0)})),this.form&&!this.form.noValidate&&!o&&!r(this.host)&&i.preventDefault()},this.handleFormReset=()=>{this.options.setValue(this.host,""),this.setUserInteracted(this.host,!1),v.set(this.host,[])},this.handleInteraction=i=>{const o=v.get(this.host);o.includes(i.type)||o.push(i.type),o.length===this.options.assumeInteractionOn.length&&this.setUserInteracted(this.host,!0)},this.checkFormValidity=()=>{if(this.form&&!this.form.noValidate){const i=this.form.querySelectorAll("*");for(const o of i)if(typeof o.checkValidity=="function"&&!o.checkValidity())return!1}return!0},this.reportFormValidity=()=>{if(this.form&&!this.form.noValidate){const i=this.form.querySelectorAll("*");for(const o of i)if(typeof o.reportValidity=="function"&&!o.reportValidity())return!1}return!0},(this.host=t).addController(this),this.options={form:i=>{const o=i.form;if(o){const n=i.getRootNode().querySelector(`#${o}`);if(n)return n}return i.closest("form")},name:i=>i.name,value:i=>i.value,disabled:i=>i.disabled??!1,reportValidity:i=>typeof i.reportValidity=="function"?i.reportValidity():!0,checkValidity:i=>typeof i.checkValidity=="function"?i.checkValidity():!0,setValue:(i,o)=>{i.value=o},assumeInteractionOn:["it-input"],...e}}hostConnected(){const t=this.options.form(this.host);t&&this.attachForm(t),v.set(this.host,[]),this.options.assumeInteractionOn.forEach(e=>{this.host.addEventListener(e,this.handleInteraction)})}hostDisconnected(){this.detachForm(),v.delete(this.host),this.options.assumeInteractionOn.forEach(t=>{this.host.removeEventListener(t,this.handleInteraction)})}hostUpdated(){const t=this.options.form(this.host);t||this.detachForm(),t&&this.form!==t&&(this.detachForm(),this.attachForm(t)),this.host.hasUpdated&&this.setValidity(this.host.validity.valid)}attachForm(t){t?(this.form=t,f.has(this.form)?f.get(this.form).add(this.host):f.set(this.form,new Set([this.host])),this.form.addEventListener("formdata",this.handleFormData),this.form.addEventListener("submit",this.handleFormSubmit),this.form.addEventListener("reset",this.handleFormReset),p.has(this.form)||(p.set(this.form,this.form.reportValidity),this.form.reportValidity=()=>this.reportFormValidity()),g.has(this.form)||(g.set(this.form,this.form.checkValidity),this.form.checkValidity=()=>this.checkFormValidity())):this.form=void 0}detachForm(){if(!this.form)return;const t=f.get(this.form);t&&(t.delete(this.host),t.size<=0&&(this.form.removeEventListener("formdata",this.handleFormData),this.form.removeEventListener("submit",this.handleFormSubmit),this.form.removeEventListener("reset",this.handleFormReset),p.has(this.form)&&(this.form.reportValidity=p.get(this.form),p.delete(this.form)),g.has(this.form)&&(this.form.checkValidity=g.get(this.form),g.delete(this.form)),this.form=void 0))}setUserInteracted(t,e){e?y.add(t):y.delete(t),t.requestUpdate()}doAction(t,e){if(this.form){const i=document.createElement("button");i.type=t,i.style.position="absolute",i.style.width="0",i.style.height="0",i.style.clipPath="inset(50%)",i.style.overflow="hidden",i.style.whiteSpace="nowrap",e&&(i.name=e.name,i.value=e.value,["formaction","formenctype","formmethod","formnovalidate","formtarget"].forEach(o=>{e.hasAttribute(o)&&i.setAttribute(o,e.getAttribute(o))})),this.form.append(i),i.click(),i.remove()}}getForm(){return this.form??null}reset(t){this.doAction("reset",t)}submit(t){this.doAction("submit",t)}setValidity(t){const e=this.host,i=!!y.has(e),o=!!e.required;e.toggleAttribute("data-required",o),e.toggleAttribute("data-optional",!o),e.toggleAttribute("data-invalid",!t),e.toggleAttribute("data-valid",t),e.toggleAttribute("data-user-invalid",!t&&i),e.toggleAttribute("data-user-valid",t&&i)}updateValidity(){const t=this.host;this.setValidity(t.validity.valid)}emitInvalidEvent(t){const e=new CustomEvent("it-invalid",{bubbles:!1,composed:!1,cancelable:!0,detail:{}});t||e.preventDefault(),this.host.dispatchEvent(e)||t==null||t.preventDefault()}}const N={$code:"it",$name:"Italiano",$dir:"ltr",validityRequired:"Questo campo è obbligatorio.",validityPattern:"Il valore non corrisponde al formato richiesto.",validityMinlength:"Il valore deve essere lungo almeno {minlength} caratteri.",validityMaxlength:"Il valore deve essere lungo al massimo {maxlength} caratteri."};I(N);class d extends R{constructor(){super(...arguments),this.formControlController=new _(this,{assumeInteractionOn:["it-input","it-blur","it-change"]}),this._touched=!1,this.name="",this.value="",this.disabled=!1,this.form="",this.customValidation=!1,this.validationText="",this.step="any",this.minlength=-1,this.maxlength=-1,this.required=!1,this.validationMessage=""}get validity(){var t;return(t=this.inputElement)==null?void 0:t.validity}checkValidity(){var e;return((e=this.inputElement)==null?void 0:e.checkValidity())??!0}getForm(){return this.formControlController.getForm()}reportValidity(){const t=this.inputElement.checkValidity();return this.handleValidationMessages(),t}setCustomValidity(t){this.inputElement.setCustomValidity(t),this.validationMessage=this.inputElement.validationMessage,this.formControlController.updateValidity()}_handleReady(){requestAnimationFrame(()=>{this.dispatchEvent(new CustomEvent("it-input-ready",{bubbles:!0,detail:{el:this.inputElement}}))})}_handleInput(t){this.handleValidationMessages(),this.dispatchEvent(new CustomEvent("it-input",{detail:{value:this.inputElement.value,el:this.inputElement},bubbles:!0,composed:!0}))}_handleBlur(t){this._touched=!0,this.handleValidationMessages(),this.dispatchEvent(new FocusEvent("it-blur",{bubbles:!0,composed:!0}))}_handleFocus(t){this.dispatchEvent(new FocusEvent("it-focus",{bubbles:!0,composed:!0}))}_handleClick(t){this.dispatchEvent(new MouseEvent("it-click",{bubbles:!0,composed:!0}))}handleValidationMessages(){if(!this.customValidation){const t=this.inputElement.validity;t.valueMissing?this.setCustomValidity(this.$t("validityRequired")):t.patternMismatch?this.setCustomValidity(this.$t("validityPattern")):t.tooShort?this.setCustomValidity(this.$t("validityMinlength").replace("{minlength}",this.minlength.toString())):t.tooLong?this.setCustomValidity(this.$t("validityMaxlength").replace("{maxlength}",this.maxlength.toString())):t.typeMismatch||t.rangeUnderflow||t.rangeOverflow||t.stepMismatch||t.badInput||this.setCustomValidity("")}this.validationMessage=this.inputElement.validationMessage}_handleInvalid(t){this.formControlController.setValidity(!1),this.formControlController.emitInvalidEvent(t)}_handleChange(t){const e=t.target;let i;if(e instanceof HTMLInputElement)switch(e.type){case"checkbox":case"radio":i=e.checked;break;case"file":i=e.files;break;default:i=e.value}else e instanceof HTMLSelectElement&&e.multiple?i=Array.from(e.selectedOptions).map(o=>o.value):i=e.value;this.dispatchEvent(new CustomEvent("it-change",{detail:{value:i,el:e},bubbles:!0,composed:!0}))}updated(t){var e;(e=super.updated)==null||e.call(this,t),this.customValidation?this.setCustomValidity(this.validationText??""):this.formControlController.updateValidity()}}a([V(),l("design:type",Object)],d.prototype,"_touched",void 0);a([$(".it-form__control"),l("design:type",HTMLInputElement)],d.prototype,"inputElement",void 0);a([h({type:String,reflect:!0}),l("design:type",Object)],d.prototype,"name",void 0);a([h({reflect:!0}),l("design:type",Object)],d.prototype,"value",void 0);a([h({type:Boolean,reflect:!0}),l("design:type",Object)],d.prototype,"disabled",void 0);a([h({reflect:!0,type:String}),l("design:type",Object)],d.prototype,"form",void 0);a([h({type:Boolean,reflect:!0,attribute:"custom-validation"}),l("design:type",Object)],d.prototype,"customValidation",void 0);a([h({attribute:"validity-message",reflect:!0}),l("design:type",String)],d.prototype,"validationText",void 0);a([h(),l("design:type",String)],d.prototype,"pattern",void 0);a([h(),l("design:type",Object)],d.prototype,"min",void 0);a([h(),l("design:type",Object)],d.prototype,"max",void 0);a([h(),l("design:type",Object)],d.prototype,"step",void 0);a([h({type:Number}),l("design:type",Object)],d.prototype,"minlength",void 0);a([h({type:Number}),l("design:type",Object)],d.prototype,"maxlength",void 0);a([h({type:Boolean,reflect:!0}),l("design:type",Object)],d.prototype,"required",void 0);a([V(),l("design:type",Object)],d.prototype,"validationMessage",void 0);export{B as S};
