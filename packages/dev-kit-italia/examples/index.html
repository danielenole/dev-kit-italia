<!DOCTYPE html>
<html lang="it">

<head>
  <meta charset="UTF-8" />
  <title>Test Web Components</title>
  <script src="https://unpkg.com/just-validate@latest/dist/just-validate.production.min.js"></script>
  <!-- Importa lo script del tuo Web Component -->
  <!-- <script type="module" src="dist/elements.js"></script> -->
  <script type="module">
    import "./dist/elements.js";

    registerTranslation({
      $code: 'it',
      $name: 'Italiano',
      $dir: 'ltr',
      video_consent_accept: 'Accetto i cookie',
    }, {
      $code: 'en',
      $name: 'English',
      $dir: 'ltr',
      video_consent_accept: 'Accept',
    });
  </script>


  <!-- just validate -->
  <script>
    window.addEventListener('DOMContentLoaded', () => {
      const formEl = document.querySelector('#form');

      // Inizializziamo JustValidate senza selettore, passando il form element
      const validate = new JustValidate(formEl);

      // Funzione helper per leggere valore da <it-input>
      const getItInputValue = (selector) => {
        const el = formEl.querySelector(selector);
        return el?.value || ''; // .value dovrebbe essere esposto dal tuo componente
      };

      // Aggiungiamo regole
      validate
        .addField('it-input[id="email"]', [
          {
            rule: "required",
            errorMessage: 'Email obbligatoria',
          },
          {
            validator: () => {
              const value = getItInputValue('it-input[id="email"]');
              return /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(value);
            },
            errorMessage: 'Formato email non valido',
          },
        ]).addField('it-input[id="messaggio"]', [
          {
            validator: () => {
              const value = getItInputValue('it-input[id="messaggio"]');
              return value.length>10;
            },
            errorMessage: 'Inserire almeno 10 caratteri',
          },
        ]);

      validate.onValidate((props) => {
        const { fields } = props;

        // Rimuovi TUTTI i messaggi creati da JustValidate (questi sono quelli prima del bottone submit)
        document.querySelectorAll('.just-validate-error-label').forEach(el => el.remove());
        // aggiorna il Web Component
        Object.keys(fields).forEach(k => {
          const f = fields[k];
          const wc = f.elem;
          if (wc) {
            wc.validationText = f.isValid ? '' : f.errorMessage;
          }
        });
      });

      formEl.addEventListener('submit', (e) => {
        e.preventDefault();
        if (validate.isValid) {
          console.log('Form valido!');
          // gestire qui il submit della form
          // fetch('/submit', { method: 'POST', body: ... })
        }
      });
      // oppure
      // validate.onSuccess(( event ) => {
      //  submit della form
      //   event.currentTarget.submit();
      // });
    });



  </script>

  <link rel="stylesheet" href="dist/fonts.css" />
  <!-- <link rel="stylesheet" href="../node_modules/bootstrap-italia/dist/css/bootstrap-italia.min.css" /> -->
  <link rel="stylesheet" href="dist/styles.css" />
</head>

<body>
  <!-- Usa il tuo Web Component -->
  <!-- ?outline="${params.outline}"
        ?block="${params.block}"
        ?disabled="${params.disabled}"
        type="${params.type}" -->
  <main>


          <div class="container my-5">
            <it-section><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p></it-section>
            <it-section variant="primary" inverse>
              <div class="container">
                <div class="row mb-3">
                  <div class="col-12">
                    <h2>Morbi fermentum amet</h2>
                  </div>
                </div>
                <div class="row">
                  <div class="col-12 col-lg-6 col-xl-4">
                    <p>
                      Platea dictumst vestibulum rhoncus est pellentesque elit ullamcorper dignissim cras. Dictum sit amet justo
                      donec enim diam vulputate ut. Eu nisl nunc mi ipsum faucibus.
                    </p>
                  </div>
                  <div class="col-12 col-lg-6 col-xl-4">
                    <p>
                      Eget egestas purus viverra accumsan. Diam maecenas ultricies mi eget mauris pharetra et. Etiam dignissim diam
                      quis enim. Eu nisl nunc mi ipsum faucibus.
                    </p>
                  </div>
                  <div class="col-12 col-lg-6 col-xl-4">
                    <p>
                      Euismod lacinia at quis risus sed vulputate. Scelerisque purus semper eget duis at tellus at urna condimentum.
                      Mattis enim ut tellus elementum sagittis.
                    </p>
                  </div>
                </div>
              </div>
            </it-section>
            <it-section image="https://picsum.photos/1280/720?image=81" inverse>
              <div class="container">
                <div class="col-12">
                    <h2>Morbi fermentum amet</h2>
                </div>
                <div class="row">
                  <div class="col-12 col-lg-6 col-xl-4">
                    <p>
                      Platea dictumst vestibulum rhoncus est pellentesque elit ullamcorper dignissim cras. Dictum sit amet justo
                      donec enim diam vulputate ut. Eu nisl nunc mi ipsum faucibus.
                    </p>
                  </div>
                  <div class="col-12 col-lg-6 col-xl-4">
                    <p>
                      Eget egestas purus viverra accumsan. Diam maecenas ultricies mi eget mauris pharetra et. Etiam dignissim diam
                      quis enim. Eu nisl nunc mi ipsum faucibus.
                    </p>
                  </div>
                  <div class="col-12 col-lg-6 col-xl-4">
                    <p>
                      Euismod lacinia at quis risus sed vulputate. Scelerisque purus semper eget duis at tellus at urna condimentum.
                      Mattis enim ut tellus elementum sagittis.
                    </p>
                  </div>
                </div>
              </div>
            </it-section>
            <it-section>
              <h2>it-video</h2>
              <it-video src="https://vjs.zencdn.net/v/oceans.webm"></it-video>
            </it-section>
            <it-section>
              <h2>it-button</h2>
              <it-button
                  variant="success"
                  size="lg"
                  icon
                >
                  <it-icon name="it-star-full" color="white"></it-icon> <span>Pulsante con icona</span>
              </it-button>
            </it-section>


            <it-section>
              <h2>it-icon</h2>
              <it-icon name="it-star-full" color="primary" size="xl" label="stella"></it-icon>
            </it-section>
            <it-section variant="primary" inverse>
              <div class="container">
                <div class="row mb-3">
                  <div class="col-12">
                    <h2>Sezione di esempio accessibile</h2>
                  </div>
                </div>
                <div class="row">
                  <div class="col-12 col-lg-6 col-xl-4">
                    <p>
                      Questo è un esempio di contenuto all’interno di una section. Puoi navigare con VoiceOver e verificare che venga annunciata come regione con titolo.
                    </p>
                  </div>
                  <div class="col-12 col-lg-6 col-xl-4">
                    <p>
                      Prova anche a navigare tra le regioni e gli heading usando i comandi suggeriti.
                    </p>
                  </div>
                  <div class="col-12 col-lg-6 col-xl-4">
                    <p>
                      Se tutto funziona, il contenuto sarà letto correttamente dopo il titolo della sezione.
                    </p>
                  </div>
                </div>
              </div>
            </it-section>
          </div>
    <div class="container my-5">
      <p>
        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore
        magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
        consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla
        pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est
        laborum.
      </p>


      <section class="my-4">
        <h2>it-button</h2>
        <it-button variant="success" size="lg" icon>
          <it-icon name="it-star-full" color="white"></it-icon> <span>Pulsante con icona</span>
        </it-button>
      </section>

      <section class="my-4">
        <h2>it-icon</h2>
        <it-icon name="it-star-full" color="primary" size="xl" label="stella"></it-icon>
      </section>

      <section class="my-4">
        <h2>it-chip</h2>
        <div class="d-flex align-items-center gap-4">
          <it-chip label="Chip con icona" dismissable variant="primary" size="lg">
            <it-icon name="it-star-full" color="primary" slot="icon" size="sm"></it-icon>
            <it-button slot="dismiss-button" aria-label="Dismissable">
              <it-icon name="it-close" color="primary" size="sm"></it-icon></it-icon>
            </it-button>
          </it-chip>
          <it-chip label="Chip con avatar" avatar="https://randomuser.me/api/portraits/women/44.jpg" variant="primary"
            size="lg"></it-chip>
          <it-chip label="Disabilitato" variant="primary" size="lg" disabled></it-chip>
        </div>
      </section>

      <section class="my-4">
        <h2>it-video</h2>
        <it-video src="https://vjs.zencdn.net/v/oceans.webm"></it-video>
        <div class="mt-4">
          <h3>Youtube:</h3>
          <it-video src="https://youtu.be/_0j7ZQ67KtY"></it-video>
        </div>
      </section>

      <section>
        <h2>it-input</h2>
        <h3>Input con validazione di default del browser e del componente it-input:</h3>
        <it-input id="email_default" label="E-mail" type="email" support-text="Inserisci la tua email"></it-input>
        <it-input id="cap_default" label="CAP" type="text" minlength="5"></it-input>
        <it-input id="msg2_default" label="Messaggio 2" type="textarea"
          support-text="Inserisci un commento. Max 10 caratteri" maxlength="11"></it-input>
        <br /><br />
        <h3>Input in una form con validazione esterna (tramite plugin JustValidate)</h3>
        <form id="form">
          <it-input id="nome" name="nome" label="Nome"></it-input>
          <it-input id="cognome" name="cognome" label="Cogome"></it-input>
          <it-input id="email" name="email" label="E-mail" type="email" support-text="Inserisci la tua email"
            custom-validation></it-input>
          <it-input id="messaggio" name="messaggio" label="Messaggio" type="textarea"
            support-text="Inserisci il tuo messaggio" custom-validation></it-input>
          <!-- <it-input id="password"  label="Password" type="password" minlength="10" suggestions strength-meter></it-input> -->
          <it-button type="submit" variant="primary" block>Invia</it-button></form>
        </form>
      </section>

    </div>
  </main>
  
  <footer class="it-footer">
    <div class="it-footer-main">
      <div class="container">
        <section class="pb-4">
          <div class="row clearfix">
            <div class="col-sm-12">
              <div class="it-brand-wrapper">
                <a href="#">
                  <it-icon name="it-pa" size="lg" color="white"></it-icon>
                  <div class="it-brand-text ms-3">
                    <h2 class="no_toc">Nome Ente</h2>
                    <h3 class="no_toc">Tagline</h3>
                  </div>
                </a>
              </div>
            </div>
          </div>
        </section>
        <section>
          <div class="row">
            <div class="col-lg-3 col-md-3 col-sm-6 pb-2">
              <h4>
                <a href="#" title="Vai alla pagina: Amministrazione">Amministrazione</a>
              </h4>
              <div class="link-list-wrapper">
                <ul class="footer-list link-list clearfix">
                  <li><a class="list-item" href="#">Giunta e consiglio</a></li>
                  <li><a class="list-item" href="#">Aree di competenza</a></li>
                  <li><a class="list-item" href="#">Dipendenti</a></li>
                  <li><a class="list-item" href="#">Luoghi</a></li>
                  <li><a class="list-item" href="#">Associazioni e società partecipate</a></li>
                </ul>
              </div>
            </div>
            <div class="col-lg-3 col-md-3 col-sm-6 pb-2">
              <h4>
                <a href="#" title="Vai alla pagina: Servizi">Servizi</a>
              </h4>
              <div class="link-list-wrapper">
                <ul class="footer-list link-list clearfix">
                  <li><a class="list-item" href="#">Pagamenti</a></li>
                  <li><a class="list-item" href="#">Sostegno</a></li>
                  <li><a class="list-item" href="#">Domande e iscrizioni</a></li>
                  <li><a class="list-item" href="#">Segnalazioni</a></li>
                  <li><a class="list-item" href="#">Autorizzazioni e concessioni</a></li>
                  <li><a class="list-item" href="#">Certificati e dichiarazioni</a></li>
                </ul>
              </div>
            </div>
            <div class="col-lg-3 col-md-3 col-sm-6 pb-2">
              <h4>
                <a href="#" title="Vai alla pagina: Novità">Novità</a>
              </h4>
              <div class="link-list-wrapper">
                <ul class="footer-list link-list clearfix">
                  <li><a class="list-item" href="#">Notizie</a></li>
                  <li><a class="list-item" href="#">Eventi</a></li>
                  <li><a class="list-item" href="#">Comunicati stampa</a></li>
                </ul>
              </div>
            </div>
            <div class="col-lg-3 col-md-3 col-sm-6">
              <h4>
                <a href="#" title="Vai alla pagina: Documenti">Documenti</a>
              </h4>
              <div class="link-list-wrapper">
                <ul class="footer-list link-list clearfix">
                  <li><a class="list-item" href="#">Progetti e attività</a></li>
                  <li><a class="list-item" href="#">Delibere, determine e ordinanze</a></li>
                  <li><a class="list-item" href="#">Bandi</a></li>
                  <li><a class="list-item" href="#">Concorsi</a></li>
                  <li><a class="list-item" href="#">Albo pretorio</a></li>
                </ul>
              </div>
            </div>
          </div>
        </section>
        <section class="py-4 border-white border-top">
          <div class="row">
            <div class="col-lg-4 col-md-4 pb-2">
              <h4>Contatti</h4>
              <p>
                <strong>Nome Ente</strong><br />
                Via Roma 0 - 00000 Città - Codice fiscale / P. IVA: 000000000
              </p>
              <div class="link-list-wrapper">
                <ul class="footer-list link-list clearfix">
                  <li><a class="list-item" href="#">Posta Elettronica Certificata</a></li>
                  <li>
                    <a class="list-item" href="#">URP - Ufficio Relazioni con il Pubblico</a>
                  </li>
                </ul>
              </div>
            </div>
            <div class="col-lg-4 col-md-4 pb-2">
              <div class="pb-2">
                <h4>Seguici su</h4>
                <ul class="list-inline text-left social">
                  <li class="list-inline-item">
                    <a class="p-2 text-white" href="#">
                      <it-icon color="white" size="sm" name="it-designers-italia"></it-icon>
                      <span class="visually-hidden">Designers Italia (link esterno)</span>
                    </a>
                  </li>
                  <li class="list-inline-item">
                    <a class="p-2 text-white" href="#">
                      <it-icon color="white" size="sm" name="it-twitter"></it-icon>
                      <span class="visually-hidden">X (link esterno)</span>
                    </a>
                  </li>
                  <li class="list-inline-item">
                    <a class="p-2 text-white" href="#">
                      <it-icon color="white" size="sm" name="it-medium"></it-icon>
                      <span class="visually-hidden">Medium (link esterno)</span>
                    </a>
                  </li>
                  <li class="list-inline-item">
                    <a class="p-2 text-white" href="#">
                      <it-icon color="white" size="sm" name="it-behance"></it-icon>
                      <span class="visually-hidden">Behance (link esterno)</span>
                    </a>
                  </li>
                </ul>
              </div>
            </div>
            <div class="col-lg-4 col-md-4 mt-2">
              <h4>Newsletter</h4>
              <div class="form-group d-flex gap-1">
                <it-input
                  slotted
                  type="text"
                  id="newsletter-email"
                  size="sm"
                  placeholder="Inserisci la tua email"
                  label-hidden
                >
                  <it-button type="submit" variant="primary" slot="append">Iscriviti</it-button>
                </it-input>
              </div>
            </div>
          </div>
        </section>
      </div>
    </div>
    <div class="it-footer-small-prints clearfix">
      <div class="container">
        <ul class="it-footer-small-prints-list list-inline mb-0 d-flex flex-column flex-md-row">
          <li class="list-inline-item"><a href="#">Media policy</a></li>
          <li class="list-inline-item"><a href="#">Note legali</a></li>
          <li class="list-inline-item"><a href="#">Privacy policy</a></li>
          <li class="list-inline-item"><a href="#">Mappa del sito</a></li>
          <li class="list-inline-item">
            <a href="https://form.agid.gov.it/view/xyz">
              Dichiarazione di accessibilità <span class="visually-hidden">(link esterno su sito AgID)</span>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </footer>
</body>

</html>
